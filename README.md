# üê≥ docker-ops ‚Äî —É–º–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Docker-—Å–µ—Ä–≤–∏—Å–∞–º–∏

> üîß –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –°–æ—Ö—Ä–∞–Ω–∏ –¥–∞–Ω–Ω—ã–µ. –í–æ–∑–≤—Ä–∞—â–∞–π—Å—è –∫ —Ä–∞–±–æ—á–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é.

**docker-ops** ‚Äî —ç—Ç–æ –Ω–∞–±–æ—Ä **–Ω–∞–¥—ë–∂–Ω—ã—Ö Bash-—Å–∫—Ä–∏–ø—Ç–æ–≤** –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è Docker-—Å–µ—Ä–≤–∏—Å–æ–≤.  
–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–µ–ª–∞—é—Ç **–±—ç–∫–∞–ø—ã volume –∏ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö**, —á—Ç–æ–±—ã —Ç—ã –º–æ–≥ –æ–±–Ω–æ–≤–ª—è—Ç—å —Å–µ—Ä–≤–∏—Å—ã –±–µ–∑ —Å—Ç—Ä–∞—Ö–∞ –ø–æ—Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ.

> üí° –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏, —Ç–µ—Å—Ç–æ–≤—ã—Ö —Å—Ä–µ–¥ –∏ –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–¥–∞–∫—à–µ–Ω–æ–≤, –≥–¥–µ –≤–∞–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª—å.

---

## üì¶ –ß—Ç–æ –≤–Ω—É—Ç—Ä–∏?

| –°–∫—Ä–∏–ø—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|
| [`update-service.sh`](#update-service) | –û–±–Ω–æ–≤–ª—è–µ—Ç **–æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å** —Å –±—ç–∫–∞–ø–æ–º volume –∏ –ë–î |
| [`update-all-services.sh`](#update-all-services) | –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ **–≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤** —Å –±—ç–∫–∞–ø–∞–º–∏ |
| [`restore-service.sh`](#restore-service) | –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å –∏–∑ –±—ç–∫–∞–ø–∞ (—Ñ–∞–π–ª—ã –∏–ª–∏ –ë–î) |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. –°–∫–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
  ```bash
  git clone https://github.com/gingerfoxie/docker-ops.git
  cd docker-ops
  ```

2. –î–∞–π –ø—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ:
  ```bash
  chmod +x *.sh
  ```

3.–ù–∞—Å—Ç—Ä–æ–π –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ):
  ```bash
  #–û—Ç–∫—Ä–æ–π –ª—é–±–æ–π —Å–∫—Ä–∏–ø—Ç –∏ –∏–∑–º–µ–Ω–∏:
  PROJECT_NAME="my-poject"  # ‚Üê –Ω–∞ —Å–≤–æ—ë –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞ Docker 
  ```
üîß –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
bash ‚â• 4
docker
docker-compose
gzip, getopt, grep, cut, tr
üîÑ update-service.sh ‚Äî –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
–û–±–Ω–æ–≤–ª—è–µ—Ç –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å —Å –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º –±—ç–∫–∞–ø–æ–º volume –∏ (–¥–ª—è PostgreSQL) –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

üìå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```bash
./update-service.sh \
  --service my-poject_frontend \
  --compose ./docker-compose.yml \
  --env ./.env
```
‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
–û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
–î–µ–ª–∞–µ—Ç –±—ç–∫–∞–ø:
–§–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ docker export
–ë–î (–µ—Å–ª–∏ db_postgres) —á–µ—Ä–µ–∑ pg_dump
–£–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
–¢—è–Ω–µ—Ç –Ω–æ–≤—ã–π –æ–±—Ä–∞–∑ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ—Ä–≤–∏—Å
üíæ –ë—ç–∫–∞–ø —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤: backups/<service_name>/<volume_name>_<timestamp>.tar.gz 

üîÑ update-all-services.sh ‚Äî –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
–û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –∏–∑ docker-compose.yml, –¥–µ–ª–∞—è –±—ç–∫–∞–ø –∫–∞–∂–¥–æ–≥–æ.

üìå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```bash
./update-all-services.sh \
--compose ./docker-compose.yml \
--env ./.env
```
‚úÖ –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
–ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
–ü–æ –æ—á–µ—Ä–µ–¥–∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∏ –±—ç–∫–∞–ø–∏—Ç –∫–∞–∂–¥—ã–π
–ü–æ—Å–ª–µ –≤—Å–µ—Ö –±—ç–∫–∞–ø–æ–≤:
docker-compose down
docker-compose pull
docker-compose up -d
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç
‚ö†Ô∏è –ï—Å–ª–∏ –±—ç–∫–∞–ø –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è ‚Äî —Å–∫—Ä–∏–ø—Ç —Å–ø—Ä–æ—Å–∏—Ç, –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ª–∏. 

üîÅ restore-service.sh ‚Äî –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –±—ç–∫–∞–ø–∞
–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å –∏–∑ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –±—ç–∫–∞–ø–∞: —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

üìå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```bash
# –í—ã–±–æ—Ä –±—ç–∫–∞–ø–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
./restore-service.sh \
  --service my-poject_backend \
  --compose ./docker-compose.yml \
  --env ./.env
```
```bash
# –ò–ª–∏ —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
./restore-service.sh \
  --service db_postgres \
  --compose ./docker-compose.yml \
  --env ./.env \
  --backup ./backups/db_postgres/mydb_20250405_100000.sql
```

üõ†Ô∏è –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ç–∏–ø—ã:
.tar.gz ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
.sql ‚Äî –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ PostgreSQL (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è)
```
üîê –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤ –ë–î. 
```
üíæ –ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –±—ç–∫–∞–ø—ã?
  ```
  backups/
  ‚îî‚îÄ‚îÄ <service_name>/
      ‚îú‚îÄ‚îÄ volume_20250405_100000.tar.gz
      ‚îî‚îÄ‚îÄ mydb_20250405_100000.sql
  ```
```
üìÅ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è backups/ —Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. 
```

‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞
–ò–∑–º–µ–Ω–∏ –∏–º—è –ø—Ä–æ–µ–∫—Ç–∞
–í –∫–∞–∂–¥–æ–º —Å–∫—Ä–∏–ø—Ç–µ –Ω–∞–π–¥–∏ —Å—Ç—Ä–æ–∫—É:
```bash
PROJECT_NAME="my-poject"
```
–∏ –∑–∞–º–µ–Ω–∏ –Ω–∞ –∏–º—è —Å–≤–æ–µ–≥–æ Docker-–ø—Ä–æ–µ–∫—Ç–∞ (—Ç–æ, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å -p –≤ docker-compose).

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ë–î
‚úÖ PostgreSQL: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±—ç–∫–∞–ø –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
üöß MySQL / MongoDB ‚Äî –≤ –ø–ª–∞–Ω–∞—Ö
üß™ –ü—Ä–∏–º–µ—Ä—ã
```bash
# –û–±–Ω–æ–≤–∏—Ç—å API-—Å–µ—Ä–≤–∏—Å
./update-service.sh --service my-poject_api --compose docker-compose.yml --env .env

# –û–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë
./update-all-services.sh --compose docker-compose.yml --env .env

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ë–î
./restore-service.sh --service db_postgres --compose docker-compose.yml --env .env
```

üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
.
‚îú‚îÄ‚îÄ update-service.sh        # –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ–¥–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
‚îú‚îÄ‚îÄ update-all-services.sh   # –º–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ restore-service.sh       # –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ backups/                 # (–∞–≤—Ç–æ—Å–æ–∑–¥–∞—ë—Ç—Å—è) –±—ç–∫–∞–ø—ã
‚îú‚îÄ‚îÄ README.md
‚îî‚îÄ‚îÄ LICENSE
```
